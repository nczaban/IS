% !TEX root = ../IS.tex
\chapter{Extensive Form Games}
\section{Basics of Game Theory}
Game theory is the study of interations between decision-makers. The field defines a game as an interaction constraining the actions a player can perform and the interests of players, with the goal of game theory to determine solutions and outcomes of various games \cite{osbo94}. It is assumed that players in these games are both rational and strategic; they pursue their objectives and take the behavior of other players into account.\\

The goals of these players are represented using a utility function. This function quantifies the desirablility of various outcomes. A highly desired outcome for a player will have a higher utility than an undesirable outcome. This utility function can be based on monetary returns, point values, or general happiness, depending on the structure of the ``game.''
\section{Normal Form Games}
In the vast majority of human choices, a person will attempt to maximize their utility function; they will perform actions that benefit themselves. When there are two or more agents trying to maximize their utility, the interactions and choices between these agents, or players, become more and more complex. These interactions can be studied with game theory using the normal or strategic form.
\begin{define}
  A finite normal-form game is a tuple $(N, A, u)$ where:
  \begin{itemize}
  \item $N$ is a finite set of $n$ players, indexed by $i$
  \item $A=A_1\times\cdots\times A_n$, where $A_i$ is a finite set of actions available to player $i$. Each vector $a=(a_1,\cdots ,a_n)\in A$ is called an action profile.
    \item $u=(u_1,\cdots ,u_n)$ where $u_i : A \mapsto\mathbb{R}$ is a real-valued utility function for player $i$.
\end{itemize}
\end{define}

In an arbitrary normal-form game, there are $n$ different players contained in the set $N$, where $n$ is a positive integer. For each of these players, there is also a finite set of actions that they can take. Player $N_i$ will have the action set $A_i$. The complete action set $A$ is determined by the Cartesian product of the action sets of each player. Within $A$, a vector $a$ is the action profile; an action profile, or outcome, represents the choice that each player made \cite{osbo94}. The collection of mappings $u$ gives each action profile a particular value; these values determine which outcome is preferred by a player. In normal-form games, players are utility-maximizing agents; they will gravitate towards action profiles which give them higher utility.\\

The normal-form game can be seen in the quintessential ``Prisoner's Dilemma'' example. This game is expressed in a 2x2 matrix, with one player's choices represented in the columns and the other player's choices represented in the rows of said matrix.

\begin{figure}[h]
  \centering
  \includegraphics[width=5cm]{figures/ExampleGrid.png}
  \caption{The Prisoner's Dilemma, represented in a normal form matrix \cite{shoh09}.}
  \label{fig:prisoner}
\end{figure}

In Figure \ref{fig:prisoner}, the column labeled \textit{C} represents prisoner 2 confessing to the crime, while the column labeled \textit{D} represents prisoner 2 denying their guilt. The rows \textit{C} and \textit{D} represent the same choices for prisoner 1. For this game, $A_i$ would be the set $\{C, D\}$, as those are the two choices that each prisoner can make. The element pairs of the matrix are the utility function of each player. In this case, their utility is the number of years in jail to which a player will be sentenced. The mapping functions in $u$ correspond to the leniency of the courts. When both deny committing the crime, the prisoners each get three years in prison. If both confess to the crime, they both get one year in prison; their sentence is lighter for cooperating with the police. If only one prisoner confesses, that player gets a four year sentence, while the player who denied gets no time in jail.\\

From the perspective of an individual player, they must consider their options before proceeding. The best strategy of a player would be trivial if that player also knew which strategies the other player(s) were adopting \cite{shoh09}. However, in the prisoner's dilemma, the two are being interrogated separately. To determine their best response, the players utilize the Nash equilibrium.

\begin{define}
  Let $s_i$ be the strategy profile of agents other than agent i. A strategy profile $s=(s_1,\dots ,s_n)$ is a Nash equilibrium if, for all agents i, $s_i$ is a mixed strategy $s^*_i\in S_i$ such that $u_i(s^*_i, s_{-i}) \ge u_i(s_i, s_{-i})$ for all strategies $s_i\in S_i$.
\end{define}

Without knowing the strategy of other players, the most an agent can do is choose a strategy that is better than other strategies in all possible scenarios. 

To find the Nash equilibrium for a player in this example, the action of the other player is assumed to be constant. For example, while determining player 1's nash equilibrium, it is assumed that player 2 always confesses. This assumption limits player 1's decision to a single column in the normal form. In this column, it is trivial to find the utility-maximizing strategy. In this case, the best response to player 2's confession is for player 1 to deny the charge: 1 year in prison or no time in prison. These steps are repeated for each of player 2's possible strategies. So, assuming player 2 denies the charge, player 1's best response is again to deny the charge: 3 years in prison or 4 years in prison. Since the best response is the same for all of player 2's strategies, this player will always choose this option. Using the same process for player 2 returns the same best response. Thus, the Nash equilibrium is that both prisoners will deny the crime, and both will get 3 years in prison.

\_\_\_\_\_\_ Put a proof in here, possibly

Not all games have a Nash equilibrium; rock-paper-scissors, for instance. Take the normal-form representation of the game in Table \ref{table:RPS}. Let the utility function award players 1 point for winning the game, -1 point for losing the game, and 0 points for a draw. Let Player 1 be on the left side of the matrix, and let Player 2 be on the top of the matrix.
\begin{table}[h]
  \centering
  \begin{tabular}{r | c | c | c |}
    \multicolumn{1}{c}{Rock-Paper-Scissors}&\multicolumn{1}{c}{Rock}&\multicolumn{1}{c}{Paper}&\multicolumn{1}{c}{Scissors} \\ \cline{2-4}
    Rock & (0, 0) & (-1, 1) & (1, -1) \\ \cline{2-4}
    Paper & (1, -1) & (0, 0) & (-1, 1) \\ \cline{2-4}
    Scissors & (-1, 1) & (1, -1) & (0, 0) \\ \cline{2-4}
  \end{tabular}
  \caption{The normal-form representation of the game Rock-Paper-Scissors}
  \label{table:RPS}
\end{table}

Every row and every column in this normal-form game has the same three results, and none of the choices is a winning strategy for more than one situation. Rock may beat Scissors, but it loses to Paper. If the Nash equilibrium of Player 1 is investigated, each possible action by Player 2 results in a different best response for Player 1. Thus, there can be no equilibrium.

It is important to recognize in these two examples that both players are making their choice simultaneously. Games without simultaneous actions are not so easily expressed in normal form. For example, take a game of tic-tac-toe. For simplicity, assume that the game is played with a 2x2 board instead of a 3x3 board. Let the utility function award players 1 point for winning the game, -1 point for losing the game, and 0 points for a draw. Let UL be a piece in the upper left square, UR the upper right square, LL the lower left square, and LR the lower right square. Let Player 1 be on the left side of the matrix, and let Player 2 be on the top of the matrix. Assume Player 1 has the first turn.\\
\begin{table}[h]
  \centering
  \begin{tabular}{r | c | c | c | c |}
    \multicolumn{1}{c}{2x2 TicTacToe}&\multicolumn{1}{c}{UL}&\multicolumn{1}{c}{UR}&
    \multicolumn{1}{c}{LL}&\multicolumn{1}{c}{LR}\\ \cline{2-5}
    UL & x & (0, 0) & (0, 0) & (0, 0) \\ \cline{2-5}
    UR & (0, 0) & x & (0, 0) & (0, 0) \\ \cline{2-5}
    LL & (0, 0) & (0, 0) & x & (0, 0) \\ \cline{2-5}
    LR & (0, 0) & (0, 0) & (0, 0) & x \\ \cline{2-5}
  \end{tabular}
  \caption{The first two moves of a Tic-Tac-Toe variant using a 2x2 game board.}
  \label{table:2x2TTT}
\end{table}

Table \ref{table:2x2TTT} shows the normal form for the first two moves of this game. Since each player has only placed a single piece, neither one has won yet; thus, the utility for each space is (0,0). There are four spaces in the matrix marked with an 'x'. These spaces are infeasible; it is against the rules for someone to play on the same square as someone else. Both players have made their first move, and it is Player 1's turn once again.\\
\begin{table}[h]
  \centering
  \begin{tabular}{r | c | c | c | c |}
    \multicolumn{1}{c}{2x2 TicTacToe}&\multicolumn{1}{c}{UL}&\multicolumn{1}{c}{UR}&
    \multicolumn{1}{c}{LL}&\multicolumn{1}{c}{LR}\\ \cline{2-5}
    (UL, UR) & x & x & (1, -1) & (1, -1) \\ \cline{2-5}
    (UL, LL) & x & (1, -1) & x & (1, -1) \\ \cline{2-5}
    (UL, LR) & x & (1, -1) & (1, -1) & x \\ \cline{2-5}
    (UR, UL) & x & x & (1, -1) & (1, -1) \\ \cline{2-5}
    (UR, LL) & (1, -1) & x & x & (1, -1) \\ \cline{2-5}
    (UR, LR) & (1, -1) & x & (1, -1) & x \\ \cline{2-5}
    (LL, UL) & x & (1, -1) & x & (1, -1) \\ \cline{2-5}
    (LL, UR) & (1, -1) & x & x & (1, -1) \\ \cline{2-5}
    (LL, LR) & (1, -1) & (1, -1) & x & x \\ \cline{2-5}
    (LR, UL) & x & (1, -1) & (1, -1) & x \\ \cline{2-5}
    (LR, UR) & (1, -1) & x & (1, -1) & x \\ \cline{2-5}
    (LR, LL) & (1, -1) & (1, -1) & x & x \\ \cline{2-5}
  \end{tabular}
  \caption{The full normal form representation of a 2x2 Tic-Tac-Toe variant}
  \label{table:full2x2TTT}
\end{table}

Since the game board was shrunk for this example, the game ends after three turns with Player 1 always winning. But even in this simplified game, the normal form quickly becomes convoluted and cluttered. For games with sequential actions, the normal form is no longer sufficient to represent player choices. Instead, games with sequential actions are represented in extensive-form trees.\\

\section{Extensive Form Trees}
In a turn-based, or extensive-form game, players do not make simultaneous actions. This leads to larger variety in gameplay. A simultaneous game like Rock-Paper-Scissors relies on chance; TicTacToe relies on players anticipating the future choices their opponents will make.\\

\begin{define}
  A finite perfect information game in extensive form is a tuple $G = (N, A, H, Z, \chi, \rho, \sigma, u)$ where:
  \begin{itemize}
  \item $N$ is a set of n players;
  \item $A$ is a single set of actions;
  \item $H$ is a set of non-terminal, choice nodes;
  \item $Z$ is a set of terminal nodes, disjoint from $H$;
  \item $\chi: H\mapsto 2^A$ is the action function, mapping a set of possible actions to each choice node;
  \item $\rho: H\mapsto N$ is the player function, mapping to each non-terminal node a player who makes an action at said node;
  \item $\sigma: H\times A\mapsto H\bigcup Z$ is the successor function, mapping a choice node and an action to a new choice or terminal node. $\forall h_1, h_2\in H$ and $a_1, a_2\in A$, if $\sigma(h_1, a_1)=\sigma(h_2, a_2)$, then $h_1=h_2$ and $a_1=a_2$;
  \item $u=(u_1,...,u_n)$, where $u_i:Z\mapsto \mathbb{R}$ is a real-valued utility function for each player $i$ on a terminal node $Z$
  \end{itemize}
\end{define}

As in the normal-form definition, there are $n$ players in the game, contained in the set $N$. $A$ is the set of all actions that could be performed in the course of the game. The set $H$ contains any and all choices or turns which do not end the game, while $Z$ contains all choices or turns which do end the game. The mapping function $\chi$ allocates the choices in $H$ a subset of possible actions from the set $A$, and the mapping function $\rho$ assigns these choices to the players who make them. $\sigma$ takes the actions assigned with $\chi$ and uses them to connect various nodes in $H$ and $Z$ together, creating the sequence of events in the game. Finally, $u$ contains utility functions for each player, which determines their individual utility at each of the terminal nodes in $Z$.\\

\begin{figure}[h]
  \centering
  \includegraphics[width=10cm]{figures/ExampleTree.png}
  \caption{An extensive-form tree for The Sharing Game}
  \label{fig:sharingTree}
\end{figure}

An example of the extensive-form tree can be seen in Figure \ref{fig:sharingTree}. The six leaf nodes of this tree are the elements of the set $Z$, while the other nodes are contained in $H$. The $H$ nodes are labeled either 1 or 2, denoting from the $\rho$ function which player is making the choice at that node. The $Z$ nodes each have a pair, denoting the utility each player will gain if the game ends in that particular way. The actions $A$ are denoted in the lines connecting the nodes together. In this game, the three actions from the root node are the methods of sharing 2 presents between 2 people. The second player, once the first player has distributed the presents in a particular way, chooses whether to accept the distribution or not.\\

To explore this definition, return to the game of tic-tac-toe. Let $N={N_1, N_2}$ be the set of players in the game. In this game, $A$ is the set of playing on one of the open spaces on the board; for the first move of the game, $A$ is the set of 9 open spaces on the board, for the second move, $A$ is the set of the remaining 8 spaces. For a game of tic-tac-toe, $H$ contains configuration of the board where neither player has three in a row and there are still open squares on the board. $Z$, on the other hand, contains the board configurations where one player has three in a row or all spaces have been claimed. For tic-tac-toe, the $\chi$ function removes illegal actions from a node, which in tic-tac-toe would be playing on an occupied square. Thus, the $\chi$ function leaves the choice nodes at each successive turn with fewer and fewer available actions. Since there are only two players, the $\rho$ function alternates between players after each action.